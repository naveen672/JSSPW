import{w as X,r as v,x as Y,m as S,aa as b,ab as N,j as e,L as C,n as Z,o as ee,p as se,q as ne,s as te,y as ae,z as m,v as D}from"./index-C-yBDewJ.js";import{A as re}from"./AdminLayout-DVxqQUWq.js";import{B as j}from"./smalllogo1-Dqd9b7yB.js";import{D as E,a as ie,b as L,c as O,d as P,e as q,f as M,T as le,g as ce,h as oe,i as F,j as p,k as de,l as u,A as he,m as xe,n as me,o as je,p as ue,q as pe,r as ge,s as fe,t as we,u as ye}from"./alert-dialog-BUU8p5Re.js";import{F as B,a as c,b as o,c as d,d as h,f as x,e as g,I as H}from"./input-BAAG4IVG.js";import{T as I,P as ve}from"./index-DOZCFxMW.js";import{P as be,S as K}from"./switch-bx-Q08M0.js";import{B as Ne}from"./badge-DQ6KtdIx.js";import"./calendar-DWCOf2qh.js";import"./file-text-DVVDHAI9.js";const U=m.object({text:m.string().min(5,"News text must be at least 5 characters long").max(200,"News text must be less than 200 characters"),link:m.string().url("Must be a valid URL").or(m.string().length(0)),active:m.boolean().default(!0)});function Pe(){const{toast:r}=X(),[z,k]=v.useState(!1),[R,f]=v.useState(!1),[T,A]=v.useState(null),{data:n,isLoading:Q}=Y({queryKey:["/api/admin/flash-news"]}),i=S({resolver:D(U),defaultValues:{text:"",link:"",active:!0}}),l=S({resolver:D(U),defaultValues:{text:"",link:"",active:!0}}),w=b({mutationFn:async s=>{const t=await fetch("/api/admin/flash-news",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok){const a=await t.json();throw new Error(a.message||"Failed to create flash news")}return await t.json()},onSuccess:()=>{r({title:"Success",description:"Flash news created successfully"}),k(!1),i.reset(),N.invalidateQueries({queryKey:["/api/admin/flash-news"]})},onError:s=>{r({title:"Error",description:s.message,variant:"destructive"})}}),y=b({mutationFn:async({id:s,data:t})=>{const a=await fetch(`/api/admin/flash-news/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){const W=await a.json();throw new Error(W.message||"Failed to update flash news")}return await a.json()},onSuccess:()=>{r({title:"Success",description:"Flash news updated successfully"}),f(!1),A(null),N.invalidateQueries({queryKey:["/api/admin/flash-news"]})},onError:s=>{r({title:"Error",description:s.message,variant:"destructive"})}}),J=b({mutationFn:async s=>{const t=await fetch(`/api/admin/flash-news/${s}`,{method:"DELETE"});if(!t.ok){const a=await t.json();throw new Error(a.message||"Failed to delete flash news")}return await t.json()},onSuccess:()=>{r({title:"Success",description:"Flash news deleted successfully"}),N.invalidateQueries({queryKey:["/api/admin/flash-news"]})},onError:s=>{r({title:"Error",description:s.message,variant:"destructive"})}}),V=s=>{w.mutate(s)},$=s=>{T&&y.mutate({id:T.id,data:s})},_=s=>{A(s),l.reset({text:s.text,link:s.link||"",active:s.active}),f(!0)},G=s=>{J.mutate(s)};return e.jsxs(re,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Flash News"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage ticker announcements that appear at the top of the website"})]}),e.jsxs(E,{open:z,onOpenChange:k,children:[e.jsx(ie,{asChild:!0,children:e.jsxs(j,{children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Add Flash News"]})}),e.jsxs(L,{children:[e.jsxs(O,{children:[e.jsx(P,{children:"Add New Flash News"}),e.jsx(q,{children:"Create a new announcement to display in the news ticker"})]}),e.jsx(B,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(V),className:"space-y-4",children:[e.jsx(c,{control:i.control,name:"text",render:({field:s})=>e.jsxs(o,{children:[e.jsx(d,{children:"Announcement Text"}),e.jsx(h,{children:e.jsx(I,{placeholder:"Enter announcement text...",...s,className:"resize-none"})}),e.jsx(x,{children:"Keep announcements short and clear (max 200 characters)"}),e.jsx(g,{})]})}),e.jsx(c,{control:i.control,name:"link",render:({field:s})=>e.jsxs(o,{children:[e.jsx(d,{children:"Link (Optional)"}),e.jsx(h,{children:e.jsx(H,{placeholder:"https://example.com/news",...s})}),e.jsx(x,{children:"URL to direct visitors when they click the announcement"}),e.jsx(g,{})]})}),e.jsx(c,{control:i.control,name:"active",render:({field:s})=>e.jsxs(o,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{children:"Active Status"}),e.jsx(x,{children:"Announcement will only show if active"})]}),e.jsx(h,{children:e.jsx(K,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(M,{children:e.jsx(j,{type:"submit",disabled:w.isPending,children:w.isPending?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Flash News"})})]})})]})]})]}),e.jsxs(Z,{children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Flash News List"}),e.jsx(ne,{children:"All flash news announcements in the system"})]}),e.jsx(te,{children:Q?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(C,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs(le,{children:[e.jsxs(ce,{children:["Total of ",(n==null?void 0:n.length)||0," flash news items"]}),e.jsx(oe,{children:e.jsxs(F,{children:[e.jsx(p,{children:"Text"}),e.jsx(p,{children:"Link"}),e.jsx(p,{children:"Status"}),e.jsx(p,{className:"text-right",children:"Actions"})]})}),e.jsx(de,{children:(n==null?void 0:n.length)===0?e.jsx(F,{children:e.jsxs(u,{colSpan:4,className:"text-center py-8 text-muted-foreground",children:[e.jsx(ae,{className:"h-8 w-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"No flash news found. Create your first announcement."})]})}):n==null?void 0:n.map(s=>e.jsxs(F,{children:[e.jsx(u,{className:"font-medium max-w-[300px] truncate",children:s.text}),e.jsx(u,{className:"max-w-[200px] truncate",children:s.link?e.jsx("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:s.link}):e.jsx("span",{className:"text-muted-foreground",children:"No link"})}),e.jsx(u,{children:e.jsx(Ne,{variant:s.active?"default":"outline",children:s.active?"Active":"Inactive"})}),e.jsx(u,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(j,{variant:"outline",size:"icon",onClick:()=>_(s),children:e.jsx(ve,{className:"h-4 w-4"})}),e.jsxs(he,{children:[e.jsx(xe,{asChild:!0,children:e.jsx(j,{variant:"outline",size:"icon",className:"text-red-500",children:e.jsx(me,{className:"h-4 w-4"})})}),e.jsxs(je,{children:[e.jsxs(ue,{children:[e.jsx(pe,{children:"Are you sure you want to delete this flash news?"}),e.jsx(ge,{children:"This action cannot be undone. This will permanently delete the flash news announcement from the system."})]}),e.jsxs(fe,{children:[e.jsx(we,{children:"Cancel"}),e.jsx(ye,{onClick:()=>G(s.id),className:"bg-red-500 text-white hover:bg-red-600",children:"Delete"})]})]})]})]})})]},s.id))})]})})]})]}),e.jsx(E,{open:R,onOpenChange:f,children:e.jsxs(L,{children:[e.jsxs(O,{children:[e.jsx(P,{children:"Edit Flash News"}),e.jsx(q,{children:"Update the selected flash news announcement"})]}),e.jsx(B,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit($),className:"space-y-4",children:[e.jsx(c,{control:l.control,name:"text",render:({field:s})=>e.jsxs(o,{children:[e.jsx(d,{children:"Announcement Text"}),e.jsx(h,{children:e.jsx(I,{placeholder:"Enter announcement text...",...s,className:"resize-none"})}),e.jsx(x,{children:"Keep announcements short and clear (max 200 characters)"}),e.jsx(g,{})]})}),e.jsx(c,{control:l.control,name:"link",render:({field:s})=>e.jsxs(o,{children:[e.jsx(d,{children:"Link (Optional)"}),e.jsx(h,{children:e.jsx(H,{placeholder:"https://example.com/news",...s})}),e.jsx(x,{children:"URL to direct visitors when they click the announcement"}),e.jsx(g,{})]})}),e.jsx(c,{control:l.control,name:"active",render:({field:s})=>e.jsxs(o,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{children:"Active Status"}),e.jsx(x,{children:"Announcement will only show if active"})]}),e.jsx(h,{children:e.jsx(K,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(M,{children:e.jsx(j,{type:"submit",disabled:y.isPending,children:y.isPending?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):"Update Flash News"})})]})})]})})]})}export{Pe as default};
