import{e as z,Y as ce,r as m,W as de,j as e,H as y,X as T,Z as ue,E as D,w as me,x as he,aa as k,ab as I,n as xe,o as je,p as fe,q as pe,s as ge,L as ve,M as be}from"./index-C-yBDewJ.js";import{n as Q,e as Ne,b as ye,o as we,I as Te,A as Ce}from"./AdminLayout-DVxqQUWq.js";import{T as Ae,g as De,h as Me,i as C,j as v,k as Se,l as g,A as P,m as F,n as $,o as _,p as L,q as V,r as q,s as H,t as B,u as G,D as Re,b as Ee,c as ke,d as Ie,e as Pe,f as Fe}from"./alert-dialog-BUU8p5Re.js";import{B as b}from"./smalllogo1-Dqd9b7yB.js";import{B as N}from"./badge-DQ6KtdIx.js";import{M as $e,E as _e}from"./message-square-UIvlSlk3.js";import{f as K}from"./format-BEMO4FpZ.js";import"./calendar-DWCOf2qh.js";import"./file-text-DVVDHAI9.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=z("MailOpen",[["path",{d:"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z",key:"1jhwl8"}],["path",{d:"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10",key:"1qfld7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=z("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var M="Tabs",[Ve,Je]=ce(M,[Q]),U=Q(),[qe,S]=Ve(M),Z=m.forwardRef((t,a)=>{const{__scopeTabs:i,value:r,onValueChange:o,defaultValue:u,orientation:l="horizontal",dir:n,activationMode:j="automatic",...f}=t,d=Ne(n),[c,h]=de({prop:r,onChange:o,defaultProp:u});return e.jsx(qe,{scope:i,baseId:ye(),value:c,onValueChange:h,orientation:l,dir:d,activationMode:j,children:e.jsx(y.div,{dir:d,"data-orientation":l,...f,ref:a})})});Z.displayName=M;var W="TabsList",X=m.forwardRef((t,a)=>{const{__scopeTabs:i,loop:r=!0,...o}=t,u=S(W,i),l=U(i);return e.jsx(we,{asChild:!0,...l,orientation:u.orientation,dir:u.dir,loop:r,children:e.jsx(y.div,{role:"tablist","aria-orientation":u.orientation,...o,ref:a})})});X.displayName=W;var Y="TabsTrigger",J=m.forwardRef((t,a)=>{const{__scopeTabs:i,value:r,disabled:o=!1,...u}=t,l=S(Y,i),n=U(i),j=ae(l.baseId,r),f=te(l.baseId,r),d=r===l.value;return e.jsx(Te,{asChild:!0,...n,focusable:!o,active:d,children:e.jsx(y.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":f,"data-state":d?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:j,...u,ref:a,onMouseDown:T(t.onMouseDown,c=>{!o&&c.button===0&&c.ctrlKey===!1?l.onValueChange(r):c.preventDefault()}),onKeyDown:T(t.onKeyDown,c=>{[" ","Enter"].includes(c.key)&&l.onValueChange(r)}),onFocus:T(t.onFocus,()=>{const c=l.activationMode!=="manual";!d&&!o&&c&&l.onValueChange(r)})})})});J.displayName=Y;var ee="TabsContent",se=m.forwardRef((t,a)=>{const{__scopeTabs:i,value:r,forceMount:o,children:u,...l}=t,n=S(ee,i),j=ae(n.baseId,r),f=te(n.baseId,r),d=r===n.value,c=m.useRef(d);return m.useEffect(()=>{const h=requestAnimationFrame(()=>c.current=!1);return()=>cancelAnimationFrame(h)},[]),e.jsx(ue,{present:o||d,children:({present:h})=>e.jsx(y.div,{"data-state":d?"active":"inactive","data-orientation":n.orientation,role:"tabpanel","aria-labelledby":j,hidden:!h,id:f,tabIndex:0,...l,ref:a,style:{...t.style,animationDuration:c.current?"0s":void 0},children:h&&u})})});se.displayName=ee;function ae(t,a){return`${t}-trigger-${a}`}function te(t,a){return`${t}-content-${a}`}var He=Z,ne=X,ie=J,re=se;const Be=He,oe=m.forwardRef(({className:t,...a},i)=>e.jsx(ne,{ref:i,className:D("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a}));oe.displayName=ne.displayName;const A=m.forwardRef(({className:t,...a},i)=>e.jsx(ie,{ref:i,className:D("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a}));A.displayName=ie.displayName;const Ge=m.forwardRef(({className:t,...a},i)=>e.jsx(re,{ref:i,className:D("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a}));Ge.displayName=re.displayName;function es(){const{toast:t}=me(),[a,i]=m.useState(null),[r,o]=m.useState(!1),[u,l]=m.useState("all"),{data:n,isLoading:j}=he({queryKey:["/api/admin/contact-messages"]}),f=k({mutationFn:async s=>{const p=await fetch(`/api/admin/contact-messages/${s}/read`,{method:"PATCH"});if(!p.ok){const w=await p.json();throw new Error(w.message||"Failed to mark message as read")}return await p.json()},onSuccess:()=>{t({title:"Success",description:"Message marked as read"}),I.invalidateQueries({queryKey:["/api/admin/contact-messages"]})},onError:s=>{t({title:"Error",description:s.message,variant:"destructive"})}}),d=k({mutationFn:async s=>{const p=await fetch(`/api/admin/contact-messages/${s}`,{method:"DELETE"});if(!p.ok){const w=await p.json();throw new Error(w.message||"Failed to delete message")}return await p.json()},onSuccess:()=>{t({title:"Success",description:"Message deleted successfully"}),o(!1),I.invalidateQueries({queryKey:["/api/admin/contact-messages"]})},onError:s=>{t({title:"Error",description:s.message,variant:"destructive"})}}),c=s=>{i(s),o(!0),s.isRead||f.mutate(s.id)},h=s=>{d.mutate(s)},R=s=>{window.open(`mailto:${s}`)},x=n==null?void 0:n.filter(s=>u==="unread"?!s.isRead:!0),le=(n==null?void 0:n.filter(s=>!s.isRead).length)||0,E=(n==null?void 0:n.length)||0;return e.jsxs(Ce,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Messages"}),e.jsx("p",{className:"text-muted-foreground",children:"View and manage contact form submissions"})]}),e.jsxs(xe,{children:[e.jsx(je,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx(fe,{children:"Contact Messages"}),e.jsx(pe,{children:"Messages from visitors through the contact form"})]}),e.jsx(Be,{defaultValue:"all",value:u,onValueChange:l,className:"mt-4 md:mt-0",children:e.jsxs(oe,{children:[e.jsxs(A,{value:"all",children:["All",e.jsx(N,{variant:"outline",className:"ml-2",children:E})]}),e.jsxs(A,{value:"unread",children:["Unread",e.jsx(N,{className:"ml-2",children:le})]})]})})]})}),e.jsx(ge,{children:j?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(ve,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs(Ae,{children:[e.jsxs(De,{children:["Showing ",(x==null?void 0:x.length)||0," of ",E," total messages"]}),e.jsx(Me,{children:e.jsxs(C,{children:[e.jsx(v,{children:"From"}),e.jsx(v,{children:"Subject"}),e.jsx(v,{children:"Message"}),e.jsx(v,{children:"Date"}),e.jsx(v,{children:"Status"}),e.jsx(v,{className:"text-right",children:"Actions"})]})}),e.jsx(Se,{children:(x==null?void 0:x.length)===0?e.jsx(C,{children:e.jsxs(g,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:[e.jsx($e,{className:"h-8 w-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"No messages found in the current view."})]})}):x==null?void 0:x.map(s=>e.jsxs(C,{className:s.isRead?"":"bg-muted/30",children:[e.jsx(g,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{children:`${s.firstName} ${s.lastName}`}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]})}),e.jsx(g,{children:s.subject||"No Subject"}),e.jsx(g,{className:"max-w-[200px]",children:e.jsx("p",{className:"truncate",children:s.message})}),e.jsx(g,{children:s.createdAt&&K(new Date(s.createdAt),"PPP")}),e.jsx(g,{children:e.jsx("div",{className:"flex items-center",children:s.isRead?e.jsxs(N,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(Le,{className:"h-3 w-3"}),e.jsx("span",{children:"Read"})]}):e.jsxs(N,{variant:"default",className:"flex items-center gap-1",children:[e.jsx(be,{className:"h-3 w-3"}),e.jsx("span",{children:"Unread"})]})})}),e.jsx(g,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{variant:"outline",size:"icon",onClick:()=>c(s),children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"icon",onClick:()=>R(s.email),children:e.jsx(O,{className:"h-4 w-4"})}),e.jsxs(P,{children:[e.jsx(F,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"icon",className:"text-red-500",children:e.jsx($,{className:"h-4 w-4"})})}),e.jsxs(_,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Are you sure you want to delete this message?"}),e.jsx(q,{children:"This action cannot be undone. This will permanently delete the contact message from the system."})]}),e.jsxs(H,{children:[e.jsx(B,{children:"Cancel"}),e.jsx(G,{onClick:()=>h(s.id),className:"bg-red-500 text-white hover:bg-red-600",children:"Delete"})]})]})]})]})})]},s.id))})]})})]})]}),a&&e.jsx(Re,{open:r,onOpenChange:o,children:e.jsxs(Ee,{className:"max-w-3xl",children:[e.jsxs(ke,{children:[e.jsxs(Ie,{children:["Message from ",`${a.firstName} ${a.lastName}`]}),e.jsx(Pe,{children:a.createdAt&&e.jsxs("span",{children:["Received on ",K(new Date(a.createdAt),"PPP 'at' p")]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"From"}),e.jsx("p",{children:`${a.firstName} ${a.lastName}`})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{children:a.email})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Subject"}),e.jsx("p",{children:a.subject||"No Subject"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Message"}),e.jsx("div",{className:"mt-2 p-4 rounded-md bg-muted whitespace-pre-wrap",children:a.message})]})]}),e.jsxs(Fe,{className:"flex gap-2 mt-6",children:[e.jsx(b,{variant:"outline",onClick:()=>o(!1),children:"Close"}),e.jsxs(b,{variant:"default",onClick:()=>R(a.email),className:"gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"Reply"]}),e.jsxs(P,{children:[e.jsx(F,{asChild:!0,children:e.jsxs(b,{variant:"destructive",className:"gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Delete"]})}),e.jsxs(_,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Are you sure you want to delete this message?"}),e.jsx(q,{children:"This action cannot be undone. This will permanently delete the contact message from the system."})]}),e.jsxs(H,{children:[e.jsx(B,{children:"Cancel"}),e.jsx(G,{onClick:()=>h(a.id),className:"bg-red-500 text-white hover:bg-red-600",children:"Delete"})]})]})]})]})]})})]})}export{es as default};
